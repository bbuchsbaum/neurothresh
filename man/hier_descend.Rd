% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hierarchical.R
\name{hier_descend}
\alias{hier_descend}
\title{Test a tree of regions with alpha-spending}
\usage{
hier_descend(
  idx_parent,
  bbox,
  alpha_budget,
  z_vec,
  pi_vec,
  x,
  y,
  z,
  perm_fun,
  n_perm,
  kappa_grid,
  gamma = 0.5,
  min_alpha = 1e-06,
  min_voxels = 8
)
}
\arguments{
\item{idx_parent}{Integer vector of parent mask-space indices}

\item{bbox}{Integer vector of length 6 for parent bounding box}

\item{alpha_budget}{Alpha budget for this subtree}

\item{z_vec}{Numeric vector of Z-scores (mask-space)}

\item{pi_vec}{Numeric vector of prior weights (mask-space)}

\item{x, y, z}{Integer vectors of coordinates (mask-space)}

\item{perm_fun}{Function that takes permutation index and returns Z vector}

\item{n_perm}{Number of permutations}

\item{kappa_grid}{Numeric vector of positive kappa values}

\item{gamma}{Fraction of alpha for testing at each level (default 0.5)}

\item{min_alpha}{Minimum alpha to continue testing (default 1e-6)}

\item{min_voxels}{Minimum region size to test (default 8)}
}
\value{
List of discovered regions with scores and p-values
}
\description{
Recursive function that tests children only if the parent is rejected,
with alpha budget allocated proportionally to prior mass.
}
\keyword{internal}
