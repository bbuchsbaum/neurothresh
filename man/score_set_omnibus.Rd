% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{score_set_omnibus}
\alias{score_set_omnibus}
\title{Compute omnibus score combining diffuse and focal detection}
\usage{
score_set_omnibus(indices, z_vec, pi_vec, kappa_grid = c(0.5, 1, 2))
}
\arguments{
\item{indices}{Integer vector of 1-based mask-space indices}

\item{z_vec}{Numeric vector of Z-scores in mask-space}

\item{pi_vec}{Numeric vector of prior weights in mask-space}

\item{kappa_grid}{Numeric vector of positive kappa values to try}
}
\value{
A list with components:
\describe{
\item{T_omnibus}{The maximum score across all statistics}
\item{U0}{The variance-stabilized diffuse score}
\item{S_best}{The best soft-max score}
\item{kappa_best}{The kappa value that gave S_best}
}
}
\description{
Computes the maximum of the variance-stabilized diffuse score U_0
and the best soft-max score S_kappa across a grid of kappa values.
}
\details{
The omnibus statistic is:
\deqn{T(R) = \max(U_0(R), \max_{\kappa} S_\kappa(R))}

where S_kappa is the normalized soft-max:
\deqn{S_\kappa(R) = \frac{1}{\kappa} \left[ \log \sum \pi \exp(\kappa Z) - \log \sum \pi \right]}
}
