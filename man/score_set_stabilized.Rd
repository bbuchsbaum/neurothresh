% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{score_set_stabilized}
\alias{score_set_stabilized}
\title{Compute variance-stabilized score U_0(R)}
\usage{
score_set_stabilized(indices, z_vec, pi_vec)
}
\arguments{
\item{indices}{Integer vector of 1-based mask-space indices defining the region}

\item{z_vec}{Numeric vector of Z-scores in mask-space}

\item{pi_vec}{Numeric vector of prior weights in mask-space}
}
\value{
A list with components:
\describe{
\item{U0}{The variance-stabilized score}
\item{n_eff}{The effective sample size: (sum(pi))^2 / sum(pi^2)}
}
}
\description{
Computes the variance-stabilized diffuse detection score:
\deqn{U_0(R) = \frac{\sum_{v \in R} \pi(v) \cdot Z(v)}{\sqrt{\sum_{v \in R} \pi(v)^2}}}
}
\details{
This provides fair comparison across regions of different sizes by
normalizing by the effective sample size.

Under the null hypothesis, U_0(R) has approximately unit variance
regardless of region size, enabling fair comparison across scales.

The effective sample size \code{n_eff} represents the equivalent
number of independent observations.
}
\examples{
\dontrun{
# Compare scores across regions of different sizes
z_vec <- rnorm(1000)
pi_vec <- rep(1, 1000)

# Small region
small <- score_set_stabilized(1:10, z_vec, pi_vec)

# Large region
large <- score_set_stabilized(1:100, z_vec, pi_vec)

# Both have comparable variance under null
}

}
\seealso{
\code{\link{score_set}} for kappa > 0 focal detection
}
