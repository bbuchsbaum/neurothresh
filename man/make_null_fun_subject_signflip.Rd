% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subject_nulls.R
\name{make_null_fun_subject_signflip}
\alias{make_null_fun_subject_signflip}
\title{Subject-level sign-flip null generator (one-sample)}
\usage{
make_null_fun_subject_signflip(
  subject_vols,
  mask = NULL,
  seed = NULL,
  z_equiv = TRUE
)
}
\arguments{
\item{subject_vols}{List of subject-level 3D volumes (arrays or \code{NeuroVol}s)
with identical dimensions.}

\item{mask}{Optional logical mask aligned to the volumes. If NULL, uses all
finite voxels common to all subjects.}

\item{seed}{Optional RNG seed.}

\item{z_equiv}{If TRUE (default), returns Z-equivalent vectors using a normal
approximation to the one-sample t statistic with df = n_subjects - 1.}
}
\value{
A list with components:
\describe{
\item{z_vol}{Observed group Z-equivalent volume (array-like, same dims).}
\item{mask}{Logical mask used.}
\item{null_fun}{Function \code{function(b)} returning a length-\code{n_mask}
Z-equivalent vector for permutation index \code{b}.}
\item{df}{Degrees of freedom used for the t-to-Z conversion.}
}
}
\description{
Constructs an observed Z-equivalent group map and a \code{null_fun(b)} that
generates sign-flip randomizations by flipping each subject map by a single
\eqn{\pm 1} (constant across voxels). This preserves the spatial covariance
structure within each subject map and is the recommended way to drive
resampling-based inference for regional statistics.
}
\examples{
subj <- replicate(10, array(rnorm(20 * 20 * 20), dim = c(20, 20, 20)), simplify = FALSE)
sf <- make_null_fun_subject_signflip(subj, seed = 1)
res <- octree_scan_fwer(sf$z_vol, mask = sf$mask, n_perm = 200, null_fun = sf$null_fun)
}
