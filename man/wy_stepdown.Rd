% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stepdown.R
\name{wy_stepdown}
\alias{wy_stepdown}
\title{Westfall-Young Step-Down Procedure}
\usage{
wy_stepdown(observed, null_matrix, alpha = 0.05)
}
\arguments{
\item{observed}{Numeric vector of observed test statistics}

\item{null_matrix}{Matrix of null statistics (n_perm x n_tests)}

\item{alpha}{Significance level (default 0.05)}
}
\value{
A data.frame with columns:
\describe{
\item{region}{Index of the region (1 to n_tests)}
\item{score}{Observed test statistic}
\item{p_adj}{Adjusted p-value (monotonically non-decreasing)}
\item{rejected}{Logical, whether the null is rejected}
}
}
\description{
Implements the Westfall-Young step-down maxT procedure for
strong control of the family-wise error rate (FWER).
}
\details{
The Westfall-Young step-down procedure provides strong FWER control
with higher power than single-step methods by:
\enumerate{
\item Sorting regions by observed score (descending)
\item Computing successive maxima from the null distribution
\item Ensuring adjusted p-values are monotonically non-decreasing
}

This is the recommended method for hierarchical LR-MFT as it
preserves the logical ordering of rejections.
}
\examples{
\dontrun{
# Observed scores for 5 regions
observed <- c(3.5, 2.1, 4.2, 1.8, 2.9)

# Null distribution from 1000 permutations
null_matrix <- matrix(rnorm(5000), nrow = 1000, ncol = 5)

# Run step-down procedure
result <- wy_stepdown(observed, null_matrix, alpha = 0.05)
}

}
\references{
Westfall, P. H., & Young, S. S. (1993). Resampling-based multiple
testing: Examples and methods for p-value adjustment. Wiley.
}
