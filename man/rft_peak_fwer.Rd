% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rft.R
\name{rft_peak_fwer}
\alias{rft_peak_fwer}
\title{RFT Peak-Level FWER}
\usage{
rft_peak_fwer(
  stat_vol,
  mask = NULL,
  fwhm_mm,
  alpha = 0.05,
  df = Inf,
  tail = c("pos", "neg", "two")
)
}
\arguments{
\item{stat_vol}{NeuroVol containing statistic map}

\item{mask}{Optional LogicalNeuroVol for analysis domain}

\item{fwhm_mm}{Smoothness in mm. Scalar or length-3 vector for
anisotropic smoothness.}

\item{alpha}{Significance level (default 0.05)}

\item{df}{Degrees of freedom. Use Inf for Gaussian field (Z-scores).}

\item{tail}{"pos" (activations), "neg" (deactivations), or "two"}
}
\value{
List with components:
\describe{
\item{threshold}{The FWER-corrected threshold}
\item{sig_mask}{Logical mask of significant voxels}
\item{method}{"rft_peak"}
}
}
\description{
Computes the FWER-corrected threshold for peak (voxelwise)
inference using Random Field Theory.
}
\details{
Uses the expected Euler characteristic approximation:
\deqn{P(\max Z > u) \approx \sum_{d=0}^{D} \text{Resels}_d \cdot EC_d(u)}

For high thresholds in smooth Gaussian fields, this provides
accurate FWER control.
}
\examples{
\dontrun{
result <- rft_peak_fwer(z_map, fwhm_mm = 8, alpha = 0.05)
}

}
