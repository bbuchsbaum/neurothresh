<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to neurothresh • neurothresh</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to neurothresh">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neurothresh</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/neurothresh-intro.html">Introduction to neurothresh</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-validation.html">Simulation Validation: FWER and Power</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/neurothresh/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to neurothresh</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/neurothresh/blob/main/vignettes/neurothresh-intro.Rmd" class="external-link"><code>vignettes/neurothresh-intro.Rmd</code></a></small>
      <div class="d-none name"><code>neurothresh-intro.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbuchsbaum/neurothresh" class="external-link">neurothresh</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-is-neurothresh">What is neurothresh?<a class="anchor" aria-label="anchor" href="#what-is-neurothresh"></a>
</h2>
<p>When analyzing neuroimaging data, we often face a fundamental
challenge: how do we decide which brain regions show real activation
versus noise? Traditional approaches like Random Field Theory (RFT)
control false positives well, but they can be overly conservative for
the spatially extended activations common in task fMRI.</p>
<p><code>neurothresh</code> implements <strong>Likelihood-Ratio
Matched-Filter Thresholding (LR-MFT)</strong>, a method designed to be
more sensitive to distributed brain activations while still maintaining
rigorous error control. The key insight is that instead of asking “is
this single voxel significant?”, we ask “is there evidence of activation
across this region?”</p>
</div>
<div class="section level2">
<h2 id="the-core-idea-aggregating-evidence">The Core Idea: Aggregating Evidence<a class="anchor" aria-label="anchor" href="#the-core-idea-aggregating-evidence"></a>
</h2>
<p>The package provides two complementary ways to score a brain
region:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Soft-max score</strong> (<code>score_set</code>): Uses a
temperature parameter κ (kappa) to balance between detecting focal peaks
(high κ) and diffuse activation (low κ).</p></li>
<li><p><strong>Variance-stabilized score</strong>
(<code>score_set_stabilized</code>): Normalizes by region size so that
small and large regions can be fairly compared.</p></li>
</ol>
<p>Let’s see how these work with a simple example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate 1000 voxels with a "hot" region (voxels 400-450)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_vox</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">z_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_vox</span><span class="op">)</span></span>
<span><span class="va">z_vec</span><span class="op">[</span><span class="fl">400</span><span class="op">:</span><span class="fl">450</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">z_vec</span><span class="op">[</span><span class="fl">400</span><span class="op">:</span><span class="fl">450</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.5</span>  <span class="co"># Add signal</span></span>
<span></span>
<span><span class="co"># Use uniform prior weights (all voxels contribute equally)</span></span>
<span><span class="va">pi_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_vox</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Score just the activated region</span></span>
<span><span class="va">region_idx</span> <span class="op">&lt;-</span> <span class="fl">400</span><span class="op">:</span><span class="fl">450</span></span>
<span></span>
<span><span class="co"># The stabilized score accounts for region size</span></span>
<span><span class="va">u0_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score_set_stabilized.html">score_set_stabilized</a></span><span class="op">(</span><span class="va">region_idx</span>, <span class="va">z_vec</span>, <span class="va">pi_vec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Soft-max scores with different kappa values</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score_set.html">score_set</a></span><span class="op">(</span><span class="va">region_idx</span>, <span class="va">z_vec</span>, <span class="va">pi_vec</span>, kappa <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score_set.html">score_set</a></span><span class="op">(</span><span class="va">region_idx</span>, <span class="va">z_vec</span>, <span class="va">pi_vec</span>, kappa <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"U0 (stabilized):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">u0_result</span><span class="op">$</span><span class="va">U0</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; U0 (stabilized): 17.148</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Effective sample size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">u0_result</span><span class="op">$</span><span class="va">n_eff</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Effective sample size: 51</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Soft-max (kappa=1):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">s1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Soft-max (kappa=1): 6.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Soft-max (kappa=2):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">s2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Soft-max (kappa=2): 10.398</span></span></code></pre></div>
<p>The higher κ values make the score more sensitive to the strongest
peaks, while the stabilized U0 score gives fair weight to all voxels in
the region.</p>
</div>
<div class="section level2">
<h2 id="multiscale-scanning">Multiscale Scanning<a class="anchor" aria-label="anchor" href="#multiscale-scanning"></a>
</h2>
<p>One powerful feature of <code>neurothresh</code> is
<strong>multiscale scanning</strong>: testing for activation at multiple
spatial scales simultaneously. The <code><a href="../reference/octree_scan_fwer.html">octree_scan_fwer()</a></code>
function divides the brain into hierarchical cubes and tests each one,
controlling the family-wise error rate (FWER) across all tests.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a 3D volume with an embedded signal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">z_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span> <span class="op">*</span> <span class="fl">20</span> <span class="op">*</span> <span class="fl">20</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z_test</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">z_test</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Run the multiscale scan</span></span>
<span><span class="co"># fwhm_vox specifies the smoothness of the data (in voxels)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/octree_scan_fwer.html">octree_scan_fwer</a></span><span class="op">(</span><span class="va">z_test</span>, n_perm <span class="op">=</span> <span class="fl">200</span>, null <span class="op">=</span> <span class="st">"mc_fwhm"</span>,</span>
<span>                            fwhm_vox <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Threshold for significance:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">u</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Threshold for significance: 7.802</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observed maximum score:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">M_obs</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observed maximum score: 15.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Significant?"</span>, <span class="va">result</span><span class="op">$</span><span class="va">M_obs</span> <span class="op">&gt;=</span> <span class="va">result</span><span class="op">$</span><span class="va">u</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Significant? TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-real-neuroimaging-data">Working with Real Neuroimaging Data<a class="anchor" aria-label="anchor" href="#working-with-real-neuroimaging-data"></a>
</h2>
<p>In practice, you’ll work with NIfTI files loaded via
<code>neuroim2</code>. Here’s the typical workflow:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbuchsbaum/neuroim2" class="external-link">neuroim2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbuchsbaum/neurothresh" class="external-link">neurothresh</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load your statistical map (already in Z-scores, or use canonicalize_stat())</span></span>
<span><span class="va">z_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbuchsbaum.github.io/neuroim2/reference/read_vol.html" class="external-link">read_vol</a></span><span class="op">(</span><span class="st">"zstat1.nii.gz"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional: provide prior weights (e.g., from a meta-analysis or atlas)</span></span>
<span><span class="va">prior_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbuchsbaum.github.io/neuroim2/reference/read_vol.html" class="external-link">read_vol</a></span><span class="op">(</span><span class="st">"prior.nii.gz"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run hierarchical LR-MFT analysis</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hier_scan.html">hier_scan</a></span><span class="op">(</span></span>
<span>  <span class="va">z_map</span>,</span>
<span>  prior_vol <span class="op">=</span> <span class="va">prior_map</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span><span class="op">)</span>,  <span class="co"># Test multiple scales</span></span>
<span>  n_perm <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"stepdown"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="converting-different-statistic-types">Converting Different Statistic Types<a class="anchor" aria-label="anchor" href="#converting-different-statistic-types"></a>
</h2>
<p>Not all software outputs Z-scores. Use
<code><a href="../reference/canonicalize_stat.html">canonicalize_stat()</a></code> to convert from t-statistics or
p-values:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From t-statistics (need to specify degrees of freedom)</span></span>
<span><span class="va">z_from_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/canonicalize_stat.html">canonicalize_stat</a></span><span class="op">(</span><span class="va">t_map</span>, stat_type <span class="op">=</span> <span class="st">"t"</span>, df <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># From -log10(p) values (common in GWAS-style analyses)</span></span>
<span><span class="va">z_from_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/canonicalize_stat.html">canonicalize_stat</a></span><span class="op">(</span><span class="va">neglog10p_map</span>, stat_type <span class="op">=</span> <span class="st">"neglog10p"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="choosing-a-null-model">Choosing a Null Model<a class="anchor" aria-label="anchor" href="#choosing-a-null-model"></a>
</h2>
<p>A critical choice is how to generate null distributions for
permutation testing. The safest approach depends on your data:</p>
<p><strong>If you have subject-level maps</strong> (recommended): Use
sign-flipping at the subject level. This preserves the spatial
correlation structure.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subject_maps is a list of 3D arrays, one per subject</span></span>
<span><span class="va">null_gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_null_fun_subject_signflip.html">make_null_fun_subject_signflip</a></span><span class="op">(</span><span class="va">subject_maps</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/octree_scan_fwer.html">octree_scan_fwer</a></span><span class="op">(</span></span>
<span>  <span class="va">null_gen</span><span class="op">$</span><span class="va">z_vol</span>,</span>
<span>  mask <span class="op">=</span> <span class="va">null_gen</span><span class="op">$</span><span class="va">mask</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  null_fun <span class="op">=</span> <span class="va">null_gen</span><span class="op">$</span><span class="va">null_fun</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>If you only have a group map</strong>: Use model-based null
generation with estimated smoothness:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate smoothness from the map and generate correlated null fields</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/octree_scan_fwer.html">octree_scan_fwer</a></span><span class="op">(</span><span class="va">z_map</span>, n_perm <span class="op">=</span> <span class="fl">2000</span>, null <span class="op">=</span> <span class="st">"mc_fwhm"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-with-traditional-methods">Comparison with Traditional Methods<a class="anchor" aria-label="anchor" href="#comparison-with-traditional-methods"></a>
</h2>
<p><code>neurothresh</code> includes implementations of standard
neuroimaging thresholding methods, useful for benchmarking:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random Field Theory peak-level correction</span></span>
<span><span class="va">rft</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rft_peak_fwer.html">rft_peak_fwer</a></span><span class="op">(</span><span class="va">z_map</span>, fwhm_mm <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Threshold-Free Cluster Enhancement</span></span>
<span><span class="va">tfce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tfce_fwer.html">tfce_fwer</a></span><span class="op">(</span><span class="va">z_map</span>, n_perm <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cluster-level FDR</span></span>
<span><span class="va">fdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster_fdr.html">cluster_fdr</a></span><span class="op">(</span><span class="va">z_map</span>, cluster_thresh <span class="op">=</span> <span class="fl">3.0</span>, q <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-functions-reference">Key Functions Reference<a class="anchor" aria-label="anchor" href="#key-functions-reference"></a>
</h2>
<table class="table">
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/hier_scan.html">hier_scan()</a></code></td>
<td>Main entry point for LR-MFT analysis</td>
</tr>
<tr class="even">
<td><code><a href="../reference/octree_scan_fwer.html">octree_scan_fwer()</a></code></td>
<td>Multiscale scanning with FWER control</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/octree_scan_stepdown.html">octree_scan_stepdown()</a></code></td>
<td>Multiscale scanning with hierarchical stepdown</td>
</tr>
<tr class="even">
<td><code><a href="../reference/score_set.html">score_set()</a></code></td>
<td>Compute soft-max score for a region</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/score_set_stabilized.html">score_set_stabilized()</a></code></td>
<td>Variance-stabilized score for fair size comparison</td>
</tr>
<tr class="even">
<td><code><a href="../reference/canonicalize_stat.html">canonicalize_stat()</a></code></td>
<td>Convert t or p-values to Z-scores</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/estimate_fwhm_vox.html">estimate_fwhm_vox()</a></code></td>
<td>Estimate smoothness from a statistical map</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="when-to-use-lr-mft">When to Use LR-MFT<a class="anchor" aria-label="anchor" href="#when-to-use-lr-mft"></a>
</h2>
<p>LR-MFT is particularly well-suited when you expect:</p>
<ul>
<li>
<strong>Spatially extended activations</strong> spanning multiple
voxels</li>
<li>
<strong>Multiple activation foci</strong> rather than a single
peak</li>
<li>
<strong>Prior information</strong> about where activations might
occur</li>
</ul>
<p>For very focal, single-peak activations, traditional RFT peak-level
inference may perform comparably. The <code>simulation-validation</code>
vignette demonstrates power comparisons.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brad Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
